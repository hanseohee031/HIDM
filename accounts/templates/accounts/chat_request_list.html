{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/chat_requests.css' %}">
{% endblock %}

{% block content %}
<div class="row chat-requests-page">

  <!-- Left: AI Matches -->
  <div class="col-md-3">
    <h4>AI Matches</h4>
    {% include 'accounts/partials/ai_matches.html' %}
  </div>

  <!-- Center: 선택된 프로필 + 요청 보내기 버튼 -->
  <div class="col-md-6" id="profile-and-form">
    <p>Select a user from the left to request a chat.</p>
  </div>

  <!-- Right: Sent / Received / Confirmed -->
  <div class="col-md-3">
    <h4>Sent Requests</h4>
    <ul class="list-unstyled">
      {% for rq in sent_requests %}
        <li>
          {{ rq.receiver.nickname }}<br>
          {{ rq.slot1|date:"Y-m-d H:i" }}, {{ rq.slot2|date:"Y-m-d H:i" }}, {{ rq.slot3|date:"Y-m-d H:i" }}
        </li>
      {% empty %}
        <li>No sent requests.</li>
      {% endfor %}
    </ul>

    <h4>Received Requests</h4>
    <ul class="list-unstyled">
      {% for rq in received_requests %}
        <li>
          {{ rq.sender.nickname }} — 
          <a href="{% url 'chat_request_confirm' rq.pk 1 %}">[1]</a>
          <a href="{% url 'chat_request_confirm' rq.pk 2 %}">[2]</a>
          <a href="{% url 'chat_request_confirm' rq.pk 3 %}">[3]</a>
        </li>
      {% empty %}
        <li>No incoming requests.</li>
      {% endfor %}
    </ul>

    <h4>Confirmed Chats</h4>
    <ul class="list-unstyled">
      {% for rq in confirmed_chats %}
        <li>
          {% if rq.sender == user %}
            {{ rq.receiver.nickname }}
          {% else %}
            {{ rq.sender.nickname }}
          {% endif %}
          at {{ rq.chosen_slot|date:"Y-m-d H:i" }} ({{ rq.get_status_display }})
        </li>
      {% empty %}
        <li>No confirmed chats.</li>
      {% endfor %}
    </ul>
  </div>

</div>
{% endblock %}
